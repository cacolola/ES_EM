---
title: "教育测量与统计——推论统计"
author: "李峰"
date: '`r strftime(Sys.time(), format = "%B %d, %Y")`'
output:
  html_document: 
    number_sections: yes
    toc: yes
---


# 分布和抽样分布


## 常见分布

### 正态分布

#### 正态分布的密度函数和形状


+ 一种常见的分布
+ 身高、体重、智力水平
+ 红细胞数、血红蛋白量
+ 产品的抗压强度、口径、长度
+ 同一种种子的重量
+ 某个地区的降水量
+ ...


![](http://i4.fuimg.com/611786/757e69a72a09a0f8.jpg)


连续型随机变量x的概率分布密度函数为：

$$f(x)=\frac{1}{\sigma\sqrt{2\pi}}e^{\frac{(x-\mu)^2}{2\sigma^2}}$$

其中，为$\mu$均值，$\sigma^2$为方差，则称随机变量$x$服从正态分布。



```{r}
a = seq(-5,5,length.out = 10000)
b = dnorm(a,0,1)  
plot(a,b,col=3,type='l')
```

```{r}
a = seq(-5,5,length.out = 10000)
b = pnorm(a,0,1)  
plot(a,b,col=4,type='l')
```


+ 单峰、对称的钟形曲线，对称轴是均值
+ 密度函数曲线在$x$等于均值时达到最大值
+ 密度函数是非负函数，渐近线是$x$轴，分布范围是($-\infty$,$\infty$)
+ 密度函数曲线与横轴所夹面积为1




```{r}
library(ggplot2)
set.seed(1234)
dat <- data.frame(rating = rnorm(200,0,1))
ggplot(dat, aes(x=rating, fill='red')) + geom_density(alpha=.3)

```


```{r}

dat <- data.frame(cond = factor(rep(c("A","B","C","D"), each=200)),                    rating = c(rnorm(200,0,1),rnorm(200,0,0.447),rnorm(200,0,2.236),rnorm(200,-2,0.5)))
ggplot(dat, aes(x=rating, fill=cond)) + geom_density(alpha=.3)
```



#### 标准正态分布的取值和概率之间的关系



![](http://i1.fuimg.com/611786/31abad736e77df22.jpg)


+ 68%的值距均值一个标准差以内
+ 95.45%的值距均值两个标准差以内
+ 99.73%距均值三个标准差以内


![](http://i1.fuimg.com/611786/a16b733ba11c27a5.gif)




#### 标准化


![](http://i1.fuimg.com/611786/63430b25f9178016.gif)


一般的意义上，标准化可以认为是一个去量纲的过程。

$$Z=\frac{x-\mu}{\sigma}$$

![](http://i1.fuimg.com/611786/b6eec9c7a4d6e557.gif)


###  二项分布


#### 二项分布的密度函数和形状


+ 重复进行n次独立试验
+  验的可能结果只有两个，成功或失败
+ 成功的概率用p表示，p在n次独立试验中不变
+ 用x表示成功的次数，n次试验中成功x次的概率服从二项分布



> 以抛硬币为例，总共抛硬币100次（size=100），得到正面记为成功，即每次成功概率为0.5（prob=0.5），理想状态下，模拟100次伯努利试验（抛100次硬币），成功的次数应为50次。
> 但是如果真的去抛100次的话，肯定不会正好是50次正面，可能是40次，也可能是60次，成功的次数是个随机变量。
> 如果我们做这种无聊的事情，连着做30轮，每一轮都记一下成功次数，再把次数和出现次数的频率整理一下，就得到了一个二项分布的分布图。


```{r}
library(ggplot2)
set.seed(1234)
dat <- data.frame(rating = rbinom(1000,100,.5))
ggplot(dat, aes(x=rating, fill='red')) + geom_density(alpha=.3)

```



二项分布的概率分布密度函数为：

$$f(x)=\frac{n!}{x!(n-x)!}p^x(1-p)^{(n-x)}$$

> 比如，某社团非常关心成员的流失情况，他们发现近些年，每年都有十分之一的社团成员不再参加任何社团活动。那么，3个社团成员中有一个下一年不再参加社团活动的概率是多少？

$$p=0.1,n=3,x=1$$

$$f(1)=\frac{3!}{1!(3-1)!}0.1^1(1-0.1)^{(3-1)}=0.243$$


#### 二项分布和正态分布的关系

n比较大，且np与nq不小于5，二项分布接近正态分布，其中：

$$\mu=np$$
$$\sigma=\sqrt{npq}$$



## 抽样分布

### 中心极限定理

http://onlinestatbook.com/stat_sim/sampling_dist/index.html





设$x$是具有期望值为$\mu$，方差为$\sigma^2$的任意总体，则样本平均数$\bar{x}$的抽样分布，将随着$n$的增大而趋于正态分布，分布形式:
$$\bar{x} \thicksim N(\mu,\frac{\sigma^2}{n})$$


> 每个游客平均产生2kg的垃圾，标准差是1.5kg，帐篷节当天，武功山有两万左右的游客，那么当地的环保部门打算组织10辆次的压缩式垃圾车（载重量4.05吨）把这些垃圾运走，垃圾车把垃圾全部运走的概率是多大？


### t分布

若$n>=30$时，则可认为均值分布趋近于正态分布。若$n<30$，则可认为均值分布服从t分布。


当总体标准差$\sigma$未知，以样本标准差$s$代替$\sigma$所得到的统计量:

$$t \thicksim \frac{\bar{x}-\mu}{s^{\bar{x}}}$$

+ t分布受自由度制约，每一个自由度都有一条t分布密度曲线。
+ 以纵轴为对称轴，左右对称，且在t=0取得最大值。
+ 与标准正态分布曲线相比，t分布顶部略低，两尾稍高且平；df越小，这种趋势越明显，df越大，t分布越趋近于正态分布。
+ 当n>30时，t分布和正态分布的区别很小；当n>100时，t分布与标准正态分布相同。



```{r}
set.seed(12345)
x<-rnorm(1000,0,1)
Ord<-order(x,decreasing=FALSE)
x<-x[Ord]
y<-dnorm(x,0,1)
plot(x,y,type="l",ylab="密度",main="标准正态分布与不同自由度下的t分布密度函数",lwd=1.5)
lc<-2
for(i in c(2,5,30)){
  x<-rt(1000,i)
  Ord<-order(x,decreasing=FALSE)
  x<-x[Ord]
  y<-dt(x,i)
  lines(x,y,lty=lc)
  lc<-lc+1
}
legend("topright",title="自由度",c("标准正态分布","2个","5个","30个"),lty=c(1,2,3,4),cex=0.5,bty="n")

```


# 假设检验


## 系统变异和随机误差


> 最近的研究表明，卵磷脂（在大豆、蛋和肝中含有）被确定能增加特定的脑化学物质，这种物质能帮助调节记忆及运动协调性。研究者采用两组分开的刚出生的老鼠样本，第一个样本中的10只老鼠给予常规饮食，包含标准数量的卵磷脂，另一个样本中的5只老鼠喂养特殊饮食，几乎不含卵磷脂。
6个月之后，每只老鼠分别接受特定设计的学习题目的测验，这些题目同时需要记忆与运动协调性。实验的目的是为了显示由于缺少卵磷脂而产生的行为缺陷。每只老鼠的分数是在它解决题目时犯的错误次数。


假设检验就是比较系统变异和随机误差的大小。

![](http://i2.tiimg.com/611786/7390fd43b4a637f5.jpg)


## t检验



### 应用场景

一位老师给9位学生一个20分的是非题测验。他想了解学生的成绩是否比10分更差。9位学生的分数是: 6, 7, 7, 8, 8, 8, 9, 9, 10. （用 $\alpha$ = 0.05的显著性水平）

























